function [Y,Xf,Af] = myNeuralNetworkFunction(X,~,~)
%MYNEURALNETWORKFUNCTION neural network simulation function.
%
% Generated by Neural Network Toolbox function genFunction, 11-Apr-2018 20:04:31.
%
% [Y] = myNeuralNetworkFunction(X,~,~) takes these arguments:
%
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = Qx17 matrix, input #1 at timestep ts.
%
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = Qx100 matrix, output #1 at timestep ts.
%
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Layer 1
IW1_1 = [0.99999999999999956 0.85155452602319603 0.63253733520692479 -0.0015889605089931987 0.58179443129875885 -0.38317164561343942 -0.089741077384880449 0.31559907153519823 0.52439748324629076 0.00020176683463981031 -0.054614778696922162 -0.14410695386595213 -0.047792726676242625 0.031462131566511412 0.047277866064050787 -0.12639584021953112 0.12537781942354709;0.48611111111111127 0.93829214296309782 0.80083473922146942 -0.069617178866097029 0.58875293058258094 -0.21775351820152766 0.14090224727050848 0.2151520539640438 0.29710962830426169 0.13753136839290289 0.25985989696920564 -0.068180763269583056 -0.17201084803080494 -0.024015921422693046 0.031228838827811162 -0.028847303325536387 0.070130712104741422;0 1.0140690095855338 0.94080964780240706 -0.14441052155481496 0.63301518135231993 -0.086177125693168433 0.38076748981055919 0.091202699331275977 0.048615880134613876 0.37007150095203534 0.67410760544471393 -0.024627510613529861 -0.33902929654775582 -0.12235573833563032 0.0018972739606824334 0.077102093982725384 0.021628198101396864;0 1.124829432990289 1.0368976967370573 -0.21789448254879781 0.60846708888604473 -0.046137303325861523 0.37622239433288757 0.11074149050258288 0.050525003468443026 0.27361333628327078 0.57569141839945637 -0.03726756245140251 -0.086329654337401251 -0.12586020518590932 0.02071080200671007 0.1070707737005878 0.013029785147921439;0 1.0841464738671327 1.0095136698177367 -0.22926079649146555 0.67509362928415073 -0.08858756330950153 0.36310735595568572 0.19721260315507175 -0.041633039786648111 0.47080288717890167 0.45472353366994644 -0.08482246202645248 -0.0066888395274304242 -0.17704097712608502 0.019451540022877252 0.028113625434273485 0.048662916846229705;0 1.1223936586847176 1.0883502696954266 -0.12489016554532724 0.57637707013632322 -0.050546230106511394 0.30738657172761874 0.64861909218362035 0.088292653347029668 0.51059586108465549 0.52419979016912988 -0.01920796680582823 -0.13425855699024974 -0.074506741545581331 0.020369246685674389 0.084083994666324421 0.0072583230983947755;0 1.0897495699759361 1.0602961451671671 0.38476176969832643 0.5441591180263462 -0.085592172395044228 0.36579268637510742 0.38769543888761848 0.13385614053008899 0.40098297406122796 0.51281544427299863 -0.010921309200198577 -0.15624643865690097 -0.082030504272971344 0.018822766785862779 0.086141829625872468 0.01160170574740272;0 1.0778980637478761 1.0580742089347077 0.93418443022854458 0.59496864402331806 -0.16256699895307331 0.4400667928931411 0.1441985638491497 0.13784146704765904 0.36406507090965545 0.48648165012564698 -0.027612680688640596 -0.13649170878462225 -0.11687541492521779 0.015324381677840013 0.062158525362382706 0.017142420790260269;0 0.17421907270204123 1.048692529729301 0.50084991021038405 0.46689429812494632 -0.063055971645533698 0.50666692538029834 0.13238219930120054 0.087898424979037632 0.35049136927311114 0.49664412460832652 -0.032878742737222591 -0.12914736659226514 -0.060333643596232708 -0.0093406212349907355 0.070172140019493609 0.013779964055286588;0 -0.93279452533019702 1.0497773167840501 -0.00096945549906568497 -0.0324268634330412 0.31647976295206698 0.79641755504649103 0.048444752081900203 -0.14677214032437499 0.19598372243866799 0.51795533082139 -0.142311157755801 -0.026341873550050399 0.0092248399718718906 -0.102967711557409 0.052794780301596997 0.063836224107070003;1 0.99372494695531577 0.65505999280383498 -0.22523394880248951 0.76947704485446 -0.23854577899900348 -0.13225033218664375 0.39562681979237702 0.36696272278736825 0.0068782026786994004 -0.038295022691738879 -0.29294725293889273 -0.12234736708986946 0.002617328104678426 0.22112279402309401 -0.124269563146867 0.12710844734284976;0 0.98482472041237257 0.92348648253791366 -0.13346832285882942 0.59268475476482108 -0.077861268460096833 0.35595930764624373 0.098112200983130018 0.069390776402287177 0.28230046852333546 0.48740730181264513 0.01411700193589639 -0.27140942338112517 -0.073518337976373541 0.013051417490072929 0.074806393308341934 0.021465521478293084;0 1.0436276987855266 0.98758579674297808 -0.13756113239525045 0.57006844991738059 -0.034243320858669067 0.33977886313572364 0.18862028087271274 0.15205349412813857 0.10254174254575003 0.5643577278410159 0.038998253711812515 -0.19792173412627789 -0.021545939167443295 0.015718546119962751 0.014642187635462458 0.010514674056227276;0 1.1669705035572699 1.11022994493493 -0.29487772518592897 0.66351546375194204 -0.056371302356253698 0.33729763301273702 0.100488105575369 -0.066480327981342902 0.28955064544731701 -0.0463863407771819 0.0752420918715936 -0.060587196567064301 -0.038016086026096102 0.069142534439493697 0.17440971697218399 -0.021191171576859999;0 1.15656092585644 1.0884223293784401 -0.11758305401525899 0.38784820793401098 0.056863476036438799 0.28897280927312502 0.50663439461357895 0.095629265713514502 0.39788182350907397 0.36988525654007598 -0.0123800153134066 0.0084201734621168808 -0.081685720961981206 0.041531994749279599 0.077880215491531304 -0.0043331103646214097;0 1.038730811157103 0.99314789613238208 -0.015355746664296075 0.3589405004613645 0.039708495331277696 0.29389332375805199 0.45012826509559523 0.17851355715384074 0.33475842982144849 0.5492104295600071 0.046039512552156096 -0.31629836896044178 -0.022655341355504927 0.023753659266174253 0.13640306688638193 0.025929776653548117;0 0.36095534906768112 0.76366756152010284 0.35158068625101613 0.47227274635977201 -0.079056275041784391 0.57317190967772214 0.24200230181119031 0.090770920471451549 0.33014880868394625 0.54080497526364169 -0.045902898895178179 -0.18589354740447622 -0.083443814117705073 0.061169362310079176 0.080530270659207315 0.018814578141174022;0 0.067114901021293832 0.75570425218501514 0.33214549305611535 0.47968811859813787 -0.10279886768534718 0.61288258575271692 0.21261813479052413 0.070478630400542835 0.32160137167321268 0.53033478778358323 -0.054329574915235934 -0.17072459383666702 -0.099797809608538485 0.057618337008428902 0.072411425039158331 0.018760580162958177;0 -0.79604982064452523 0.9002859839726427 -0.046037347360576443 0.46345575589546478 -0.14701388084001318 0.5575828849395057 0.27151053203505843 -0.026235064125905136 0.26411102450902019 0.50761687629328489 0.0055282987377235342 -0.20880732108782293 -0.099643429251455279 0.015101456847453466 0.079711645121831057 0.028178395359728721;0 -0.98022695461278064 1.0850895185114531 -0.039756276851263213 0.43963973750706481 0.025380302846738256 0.53063124153939012 0.18824942420581184 -0.010513896663141556 0.30918055244921067 0.52485284792551767 -0.041739642574508851 -0.16281809632942382 -0.015362173128883039 -0.053398789423188771 0.072556885742602495 0.018576363430353699;0.99999999999999989 1.0799882650496484 0.5914571143702323 -0.267630930756309 0.8473409884243821 -0.58279588863668519 -0.098764387456822283 0.44048690194818096 0.23239718414685018 -0.024150683763008069 -0.015233751288740865 -0.029329820586833637 -0.093051362903388835 0.060095451030504489 0.055115024401730536 -0.052769009132521284 0.10177810917623438;0.57777777777777772 1.0008673289127201 0.64079763526681965 -0.30685065986079263 0.65289111971257019 -0.18677302559081541 0.066386329340852979 0.29082912067013611 0.35158151020747941 0.063191086921315726 0.17652925980467798 -0.072023029467804936 -0.15245252726995945 0.0094020812343166334 0.0546002227957499 -0.033004792330288413 0.077438355240864204;0.29545454545454553 0.99992705767966816 0.76055700056191233 -0.29404341519475619 0.57435955664334915 -0.076916398624864477 0.24615465759651994 0.21899801277740991 0.36069754328559178 0.16735668459292039 0.31347910639778559 -0.031103355592113559 -0.17781012213712039 -0.028719311564768757 0.028286151981061384 0.0050873150842471147 0.054906961946849027;0 1.0490920027633068 0.96771829044417412 -0.26623554256475812 0.5085572346216557 -0.066582090504986743 0.56132326991174397 0.14850405122469001 0.45268063450033974 0.43847856334329738 0.4824558378744534 -0.012292560038418963 -0.2025075739797722 -0.11124194130490812 -0.00030177428965053098 0.055300842885163466 0.032256271317739116;0 1.0211270493544999 0.90925035342412031 -0.14351025589723573 0.24852671910436247 0.070171246430475231 0.38421742031538247 0.17183173290484471 0.25326691873262891 0.38116025271294768 0.46644691258867771 -0.021049478369069317 -0.17970564123970523 -0.11371923800659089 0.012239585264018103 0.091706671441529677 0.030556433600697951;0 1.0554898810506173 0.88924269267949896 0.0054241363043642547 -0.11098985888802761 0.25792828370729631 0.23522219960060856 0.18704920794544297 0.13013811959924468 0.33599274310107485 0.52640780303941725 -0.022369175290173689 -0.23441849497440823 -0.11754240238382373 0.020730462021290138 0.10715280238083093 0.032938240228412671;0 0.30263227299082895 0.67297382158956454 -0.019804093624182263 0.21992066582057926 0.071963242461406896 0.50149940657098779 0.25222677954751194 0.074787632000371723 0.33168262598958503 0.55360656314515277 -0.047510103855299482 -0.22991115594591774 -0.086781633292440208 0.066498807384630376 0.094675931268854263 0.027513484719958341;0 -0.45519437637235166 0.43927825409943833 -0.039348255445902702 0.40655214034170017 -0.045913613847886628 0.76780158126390363 0.25017815688882405 0.01142553611546469 0.32603711047863249 0.57843506454939164 -0.092433752348569917 -0.2038677324616488 -0.080733228185503242 0.11139151637259713 0.071945019556144796 0.024159636305376823;0 -0.73501209312700699 1.03086369383107 -0.0511801559595522 0.35440253042987901 -0.13791276061604699 0.65027111340632004 0.80466107597701597 0.054237809458374198 0.33818953810234798 0.46100368886343801 0.0011454999873509401 -0.288795456558814 -0.069147150921486905 -0.106811049655686 0.055036618108128099 0.00053703495906537403;0 -0.68909506116119057 1.1762967436758749 -0.019827848745175951 0.080545533501755501 -0.0076444280765812569 0.24923694321470202 0.94411663590298045 0.12160841925012365 0.50696502277850453 0.45529155016939199 0.021898345961574951 -0.30835603608918899 -0.1804607660461445 -0.0010280855642420001 -0.0010729881799066499 -0.0050204781409340597;1 0.91792709268517436 0.32763349583409318 -0.54172207262698202 0.57975162673594804 -0.24905674068389161 -0.12481101567648821 0.45240643567302519 0.49367574297357014 -0.035165585495855502 -0.06843637221097458 -0.23863088252201922 -0.10581137952858656 0.077802574803841243 0.057923680076035565 -0.056330668826350863 0.11284398359147001;1 0.98131438272486737 0.25648176987083965 -0.5967131438794675 0.66687648326180771 -0.23298630704130999 -0.14335960220430599 0.35281090847234581 0.69068943434266417 -0.045920447907593018 -0.08515028246532641 -0.17538403979614597 -0.10064161963932641 0.041405042125880497 0.079927341775617514 -0.075967524844383405 0.11781187070616563;0.6129032258064514 0.92677725435113301 0.53084852595685139 -0.45054546324077716 0.55853031043105639 -0.10966068751087299 0.11362417577142445 0.31127638155330239 0.54798440058653219 0.12637563994984127 0.11965615138302367 -0.10775756274153446 -0.10370842744580125 -0.013343561929069086 0.040335572476148905 -0.037425438480769554 0.090988369786621337;0 0.18228431153209165 0.22182302521967398 -0.196348553083911 0.55418693416285369 -0.22857730597371534 0.226294948578497 0.24869815976403598 0.088444100600654371 0.369279567527318 0.43983867953967293 -0.14500545663531567 0.10512358588322059 -0.14491094794241099 -0.030298102993938068 0.12437347483444022 0.012223390829502792;0 0.27898728354455843 0.35012895617246315 -0.029264234120060573 0.33843226809304672 -0.077256845466444901 0.24297211146663059 0.20513487346682749 0.13463587498060237 0.35144219447456143 0.48454537774364242 -0.061890743072949672 -0.19190953344248624 -0.087554126697256943 -0.0058596965520905306 0.086151377162117612 0.016511211389460316;0 0.39389288632320463 0.49135507442868948 0.013843680995907463 0.29706563423200266 0.25154864655113196 0.30078845692237738 0.18948727465772325 0.11751412260126562 0.36306869160610594 0.5261428543838983 0.075616634287334547 -0.19775381944227555 -0.14574147535782456 0.025789827859477817 0.089392488799021966 0.025369815801272833;0 -0.25408790222510225 0.31133373799633551 -0.022702416485737002 0.55622010586159998 -0.13604822488219376 0.31777100831902777 0.22015114849181799 0.15774936865213238 0.36251640815077146 0.51369851088639973 -0.075888933927485094 -0.21140902648272999 -0.032911647763219545 0.074651785440442542 0.073950096618290828 0.018772996924724956;0 -0.60831391420740744 0.66918925826723141 -0.043865383821231285 0.43298853711325491 -0.1090460586019989 0.56697388371197599 0.23156916750304019 0.044238758656509891 0.3130224312836366 0.5333453647751214 -0.046048101108408519 -0.20732442217082706 -0.12190539535882727 0.05842822795382499 0.074749360105306153 0.02284060372966917;0 -0.70107980857310803 0.83205692743830895 -0.052788785760720609 0.45272813562254588 -0.20813910717126635 0.41101805276783587 0.24536390596684388 0.10588231785157677 0.27024789264052018 0.4756162262664948 -0.029940152030172265 -0.22941667286995626 -0.22697002013692799 0.021288063989642871 0.076322068495804612 0.020348299038166526;0 -0.88086399430556783 1.033535758233195 -0.029535634891768636 0.42319645932904176 -0.060356320508447747 0.26940283938684506 0.097398045950606749 -0.0094530582138505001 0.4256924747740034 0.55235250433839567 0.0028873918116222638 -0.20713651140586276 -0.092311627429387422 -0.0080845874050843331 0.072700850665102845 0.017431984467960532;1 0.88190301184209718 0.19643366383137034 -0.51298393903643813 0.67382808055071575 -0.35734131986379314 -0.14765643920709731 0.62054447271574298 0.49493114873362193 0.049998304854478301 -0.01919408186245301 0.043928584245775865 0.034409295712914872 0.014347011708228326 0.073922783895880195 -0.12231028346351645 0.12180213459257874;1 0.81312252784667938 0.13994445370085462 -0.42936728458328832 0.72234148386303665 -0.078399581637149274 -0.15811487262247848 0.38192595971416571 0.41337390848316791 -0.02837839620050589 -0.056543359358984094 -0.16522765278520024 -0.061933201789905488 0.037920516183708015 0.042207269220040471 -0.14296473990867617 0.138017014065653;0.99999999999999978 0.9773538159216153 0.40328544431312829 -0.65883417549226753 0.65420055691895163 -0.033061689340389167 -0.15137781815417511 0.56546696585674971 0.5663612948720208 -0.029449068966802192 -0.062614919158273552 -0.1343219776699876 -0.05210288291460638 0.045918510295118113 0.062942021220593655 -0.11721697313998679 0.13347814105702077;0.49999999999999983 0.37107526637482052 0.20675786120144796 -0.25789666264892647 0.4356004764543262 -0.22617830488772817 0.080521816354742815 0.34984273283958289 0.28263183747047949 0.1482783572052746 0.20597713729018166 -0.14198080867608109 -0.12571239340980644 -0.018989429836038761 0.0089450296574582738 -0.017082394599954816 0.063555969888546504;0 -0.030699437272778865 0.092026927158582322 -0.022505035471523938 0.49394089292982502 -0.21250771252932443 0.2513780630518605 0.20676619192730139 0.14320790568268082 0.35789542815134756 0.47394670339055456 -0.067195921535751879 -0.21464746646554148 -0.075646035894608832 -0.026668064213936072 0.069661824628747787 0.0079504556164192008;0 -0.153284141526568 0.085404200326896898 0.075044592978621497 0.94881920830192101 0.56189822674238998 0.100732347274993 0.29343961993600998 0.154240671953492 0.20149653823342101 0.442529116660966 -0.34861300406936302 -0.30431020460124802 -0.16077039756307901 -0.055515442037225103 0.069934438974993102 0.0066473685255419501;0 -0.20734965483349085 0.064890280162320374 0.042220855948867035 0.71991696936830474 0.41358040811012531 0.40518921988059187 0.19270673217390158 0.084845862682530707 0.42847978769220246 0.57969092657061083 0.3969556067666633 -0.11806215886238144 -0.22341371735172896 0.032849003960099411 0.071411086113509645 0.021664073383400772;0 -0.40223897544548598 0.41230993361545099 0.0104969509681114 0.61299796426267805 0.124229857127739 0.32663339072647601 0.19107688775610401 0.0078069152899723996 0.380044378683705 0.58765239172656003 -0.025457978823681199 -0.14826167788588801 0.14239228043811999 -0.035980692867578601 0.068536652407624896 0.012894048164799899;0 -0.78478050456956272 0.90643224017064195 -0.049188612147071306 0.43291698043962124 -0.13133321187688543 0.4107133172449684 0.18089706047029822 0.072051367412927267 0.33754777250598333 0.50963510954942293 0.011485488749863586 -0.18840935385374719 -0.11454947498525775 0.028684011631226941 0.076218014663429104 0.022857396855037432;0 -0.79414742327294019 0.91638535229689089 -0.043203863755360436 0.26255559832176412 -0.037935633085230694 0.29094240040851033 0.021950158156007715 0.078692032185072536 0.40113367635864311 0.48550388551856111 -0.04020147544035868 -0.16590235156099417 -0.15163919300217882 0.031355473669010009 0.057367284747015836 0.017301904365494274;1.0000000000000002 1.1001000614832332 0.16001693913226719 -0.59838344874688609 0.75696128896826598 -0.7160381414450333 -0.12547547885132188 0.29238798041804481 0.52652460991567762 -0.023894723401806803 -0.072471288053313584 -0.095178934828785547 -0.096908809141657823 0.027486556506388354 0.085940699508641846 -0.074428681867246729 0.12598763345973082;0.99999999999999989 0.80831875132118669 0.32231060641311632 -0.52741288150293919 0.47875303217888243 -0.076947672343289697 -0.1139799766202029 0.45936809641807719 0.60873215678828463 -0.040974106760953442 -0.066581439275604504 -0.16178398535986199 -0.059433909277609137 0.040446622576905511 0.062118446645962243 -0.11713675841161726 0.12233996645822699;1.0000000000000004 0.71275554948876307 0.26774651853818676 -0.44222830554423204 0.3355034437552124 -0.26159619332252415 -0.063337542897879656 0.48665553773109838 0.37148931232581989 -0.060438250307297013 -0.054129665500509801 -0.20369712567422121 -0.081882673296804653 0.031169262625639391 0.038702849973397166 -0.1132510188179241 0.11795555259417617;0.61111111111111094 0.35071970087555016 0.16047566534920393 -0.21775648222735894 0.37035856920045546 -0.26054282986064059 0.058385229270302777 0.32056054527509764 0.3079761654057126 0.1156601266526088 0.15857493213685028 -0.12963669855405369 -0.11095479679216638 -0.0036324813176602539 0.021094300552022487 -0.045683578036808517 0.071625215247237667;0.33333333333333337 0.10482002026566993 0.11070362165414818 -0.080948858447382047 0.42459732727327559 -0.22960147805290798 0.1488001978250412 0.22905336073156493 0.2514710877553844 0.23421989152741129 0.30872095711305297 -0.082599183468522283 -0.14105626909474758 -0.029237124681610892 0.01009675862452949 0.0085228275596488084 0.039381970156928903;0.47368421052631576 -0.50813197609537375 0.17217993431884893 -0.14838523388358638 0.71432881068742549 -0.026471723551510597 0.41679400521976406 0.2818698195092304 0.30392167611042237 0.1199994942878479 0.20044936354986703 0.024807518208302556 -0.092860699654383386 -0.063257767383797611 0.045214320367225738 -0.0086531222194876183 0.071742492651210826;0.37499999999999994 -0.60284024859368668 0.38528923433489642 -0.12679012674610513 0.67973707217402668 -0.06483846527891346 0.35106517269947357 0.24235879441349856 0.2685215688993563 0.20445638391383436 0.31489102487951176 0.024320912595792936 -0.098220629414189686 -0.014702361960135326 0.054619063452209342 0.0098314247459622556 0.063183151016144287;0 -0.71413436845986122 0.88884201624357118 -0.047779229044429411 0.54755564946027935 -0.19265971017691599 0.16890769580098922 0.14468931000432217 0.23808066715483966 0.42117212363920675 0.62011139994246023 0.019069732722855049 -0.11081596101690165 0.083378692972299592 0.084527157846407991 0.075541036815019696 0.024893700022227547;0 -0.71138986589675401 1.1635522618940199 -0.034915620313522702 0.32794765168926998 0.246083361259189 0.58373329714949995 -0.098843117176937306 -0.26417346613567899 1.1740029290740099 0.67830624923528404 -0.150940805712236 -0.102220841135645 0.31258746703327001 -0.055298042410026498 0.066073569720835001 0.016108500342426599;0 -0.91716624753331177 1.0393265079867271 -0.068469745003153171 0.40375073835223785 -0.041012435516672836 0.47182094238955563 0.065183465737976995 0.21726112583662643 0.50004044785812873 0.48409422344677611 0.012210402343582831 -0.15413461124165989 -0.014330670428903902 -0.020072100003021325 0.082290864423521987 0.01359078082782234;1 0.79565205452896093 0.19999685178700977 -0.6413908373876458 1.0041989434340433 -0.35363853244563398 0.58131538284909023 0.40508548490715496 0.48821875538431991 0.22825436152663051 -0.016609241427708175 -0.11409428254139496 -0.038642288082658953 -0.040835108080108873 -0.031549053628397841 -0.17697596023346898 0.081943448876995145;1 0.81912632131326357 0.2126021626449745 -0.46865366159687838 0.4097868481276592 -0.62279008866143082 -0.12146590959614151 0.34409984011700079 0.49298736225963458 0.084660193369380216 -0.02835144577549395 -0.21834473749677674 -0.0138152960825857 0.066212756750253093 0.085878401456338987 -0.10695169419620554 0.13176456301790274;1 0.69225039465199223 0.19960538827376173 -0.41504652833784533 0.29412565436961713 -0.43771175963648512 -0.058966565094432058 0.34153130619790184 0.47248096183325239 -0.017364814325998401 -0.052242424237747359 -0.16625747703713423 -0.061687186939988939 0.025349629487783076 0.05979633796950147 -0.12270956012233875 0.12232886370504553;1 0.40874875311269032 0.11248968279969905 -0.1890603420899096 0.21089055938115181 -0.25968456566373233 -0.041595694674387305 0.27995959345703536 0.48634764101904748 -0.00178258201614681 -0.029684396171725101 -0.11210248954405058 -0.02597191879052934 0.039354280287121401 0.066086233007541781 -0.12134411505508791 0.097609962307648485;1 0.210102986622727 -0.117141911127637 -0.0584682981661305 0.35167132020854802 -0.193078283553094 -0.030057606476125698 0.144142751938443 0.36303400422481902 -0.084474607624695705 0.0272661727350864 -0.038770262724566698 -0.138317608170995 0.152680863035139 0.13002772575822399 -0.127094094972625 0.086133123270027603;0.99999999999999967 -0.18606721305937085 0.14955340773673556 -0.25445991465636109 0.47067800200862431 -0.30945658448374114 0.1803541196104578 0.30019974836135949 0.48330977796011954 -0.097452759351727439 -0.073263985772233142 -0.12158828367742332 -0.032660017032892917 0.047056035093097602 0.062924137899375759 -0.10824751716938226 0.11691899753983612;0.99999999999999978 -0.86458574305352576 0.24137868916011926 -0.35040933120162343 0.75194403959989609 -0.36508484587033679 0.53048707966121122 0.35281739710735682 0.49351366415316772 -0.27160431315727829 -0.22346403832285996 -0.14289442108994138 0.01139281848289983 0.083812149108538944 0.095204252538783243 -0.10780992031612678 0.13030421629516184;0.45714285714285718 -0.82482313322390677 0.64344846935716493 -0.19898997920748873 0.62311783483652516 -0.26503983209633863 0.31187476167505895 0.25303216127318162 0.33680626762400856 0.2267196317772503 0.26841228295973607 -0.073337839245042294 -0.11950642078057033 -0.010027258431701387 0.061585359164833438 -0.00036841348151551816 0.073175812240391935;0 -0.85070826182247716 1.0390815242451394 -0.0415902247803095 0.54386019669551056 -0.19861687166317774 0.23508261947626516 0.21691555933189169 0.09721051140889797 0.32846435442699168 0.5395568865583078 0.03177696039495069 -0.2011834666049041 -0.11614319929201414 0.027574788409180227 0.078955731821301209 0.028864117017162117;0 -0.89887363241729801 1.0487295601218403 -0.060339308595543401 0.45893462942902724 -0.15104366028692448 0.34503549959175633 0.18650805388788175 0.15306633666964561 0.31266513724137512 0.57113677785800698 0.002686091539653023 -0.16911331647363939 -0.17924627077451633 0.016069441796826307 0.076333433732707512 0.015807041153791068;1 0.93102384187786602 0.202285807561422 -0.54088988403430804 0.51075295227060002 -0.46691521560090399 -0.112961284919828 0.372403754757131 0.45139120957857198 -0.048011973293461602 -0.083791536936267397 -0.30672563133743302 -0.131002493729552 0.043171092638800597 0.053057180126079101 -0.064614195857739101 0.123109785460537;1 0.82976937761831981 0.097435727416532641 -0.42270550141772206 0.60776946042747737 -0.27984851864068683 -0.14048032981651781 0.33311394920727722 0.57034152869773935 -0.03875013537546948 -0.078270565039528908 -0.22029757783666201 -0.083928353746590759 0.035099887116858804 0.051067262294677541 -0.11739096426320542 0.1317670759365516;1.0000000000000002 0.67940427901248923 0.12864844066110925 -0.38471598388396339 0.43212129838005803 -0.28092921233137869 -0.088205117326567009 0.34701550891343519 0.45320993778147556 -0.031724786951977973 -0.047340310121679073 -0.16045797421312688 -0.06720396199614484 0.0350776531634562 0.065157248020892664 -0.14488378812857997 0.12613920257171923;1 -0.00026215829110408801 -0.056293404077058198 0.0323558019253102 0.063652454557068305 -0.0229429459348423 -0.028484049541824898 0.212589920318419 0.29193057039458098 0.029258075073120299 0.0036767391677970298 0.0134078845303875 0.0235247305463392 -0.0051670247619209197 0.086997830545684302 0.0052013835067710396 0.0046193249472830803;1.0000000000000002 -0.32754989253838651 0.17609508974196664 -0.24877163201763988 0.40867347008976779 -0.28930991590407057 -0.12527148602442681 0.29271555147268291 0.46002127115293234 -0.035405718408494526 -0.078537574044613964 -0.072128462197556337 -0.10751362800371136 0.022127361729182515 0.052140358972239564 -0.1076966363578355 0.12360833703747914;1 -0.64706153878397699 0.25099759473528699 -0.35331007508444501 0.500114718543338 -0.19365550164589099 0.17870444206885899 0.110710944217986 0.42057396919568402 -0.144318658200007 0.0134248724852168 -0.0262931209675441 -0.143947685019824 -0.035606112898835002 0.039614316724623802 -0.096323122078100606 0.161268645132113;1.0000000000000002 -0.84638727563741467 0.27537207604565678 -0.37628518317302989 0.66185554902488675 -0.33324817908896098 0.24222768301107889 0.33614581313043812 0.49187818327941368 0.13692837700659757 0.094062244156001909 -0.20519802659915701 -0.10041267079133644 -0.043510617697587427 0.053838380574932274 -0.084635075186320408 0.13798448362584023;0.24242424242424243 -0.84415360660272776 0.83189285137549196 -0.14421431161293474 0.60448836000904715 -0.23093875610039133 0.27924528663616061 0.24700575947296483 0.2674655126015687 0.31906006710437035 0.38421539502789892 -0.040700141314268405 -0.17950077680539933 -0.094364923908719506 0.040973367354528382 0.040000667332042564 0.047889283951271851;0 -0.82004475189152837 0.99152450784825408 -0.061383484137350015 0.56402644626952325 -0.22789598100238978 0.34296047719460648 0.22386723692323093 0.20626312720134973 0.37893698981044283 0.51474448488183022 0.029574679536856576 -0.20738619321165061 -0.10803053961404803 0.028415158315500285 0.089356670536048899 0.022675467751550445;0 -0.97172452152890465 1.1915200247090274 -0.063844054709444847 0.66885967756949261 -0.29179738108229275 0.3368539342198682 0.29382433779924699 0.17137701444452674 0.36034766218172848 0.54294311168646381 0.10157498937876877 -0.20294656786819273 -0.041644419466855299 -0.031627451182782242 0.10054358176481276 0.02748922355570705;1 0.86872911603386371 -0.012349574567254462 -0.46657080573533599 0.60288162957583524 -0.56751492182820229 -0.1270782963369691 0.16673284178128517 0.48801894634363646 -0.0039709273728039144 -0.064460154263522917 -0.1612451055717575 -0.076150496718997165 0.01200049666138674 0.064696800391567194 -0.11232995598357183 0.12318810648506459;0.99999999999999978 0.90971631786732321 0.050151627618787359 -0.40376597517277468 0.85517147842735808 -0.22622838993716141 -0.17698688140086458 0.30730714584809954 0.31023041579350508 -0.029636928143286456 -0.064973001570906741 -0.21818473870109215 -0.088283050589061995 0.031086107797626113 0.027911764439963821 -0.1457016023788823 0.14674444437618056;1.0000000000000002 0.64561179277613867 -0.054172490299749611 -0.18386743308848288 0.66552637201829101 -0.27410580377750843 -0.13646417271521341 0.34176720626961499 0.45683210852912304 -0.015054145340829736 -0.052951985230181409 -0.17660290176426496 -0.0625230088124928 0.032485814554031628 0.056621711336855063 -0.11722989070431272 0.12136055884587905;1.0000000000000002 0.029815752460094908 0.011392002266626122 -0.16723325338375417 0.50605936140511254 -0.38076852109799098 -0.13551461350421443 0.38835116698990557 0.4711723500252657 -0.011157109808304406 -0.084434744813527279 -0.12238388130942342 -0.10370419367222775 0.031962857947216997 0.059576717174774488 -0.12233264025996674 0.12973387407710724;1 -0.74612127798361072 0.24494021541940883 -0.30041305640821725 0.50466857526158737 -0.31496377665683434 -0.21142911949681181 0.32546697757614018 0.46312796039035059 -0.0028253989279561163 -0.15151671266863548 -0.051374925851345059 -0.18074096682166618 0.03028206432331261 0.052150524919284486 -0.11546505804114968 0.1406793133523683;1 -0.7625562534571475 0.23391460942740425 -0.30770709594396228 0.59909919466983574 -0.36850083666151973 -0.085962322287114368 0.26984940908066113 0.43743555109825749 -0.38375189273965099 0.0043739173652955973 -0.10476399881704793 -0.0445687306219896 -0.083601616219886307 0.011815349130053748 -0.086633742684268308 0.14983778533782025;1 -0.86969154933622994 0.31315788503832986 -0.39245655828937881 0.60278875328401393 -0.3588278323413589 -0.22433576584522191 0.30566359204340077 0.54037203282130897 -0.17576205935712214 0.32478355342935772 -0.13387742346160464 -0.065358155805766288 0.042234619770727566 0.043795902647818553 -0.092228044499748682 0.15465323174514986;1 -1.0075551078530978 0.35102444025817148 -0.45299361424164325 0.73005335100269808 -0.40704405044626146 0.08011911029826925 0.34923833438615004 0.49339306114780629 0.16235737718883314 -0.22756176009488449 -0.20745914095994578 -0.032762182686627485 0.04815352496263528 0.068565535649365128 -0.1339651585595944 0.10642138939153148;0 -0.82358801664514036 0.96822787235493568 -0.042306234789049962 0.62542694075733085 -0.078599455375704994 0.29906782138174559 0.22737013024739022 0.19936832178208422 0.34591986815606124 0.47203542697994083 -0.043059557668676231 -0.24185527967457499 -0.1617921963997444 0.021137236363205688 0.088306968548787168 0.019723916925576283;0 -0.93366395132209601 1.0630437849760799 -0.0053531655485336057 0.60836277320256071 0.20453462638454567 0.21855546357701497 0.14136604990626733 0.19331893979950401 0.35204232378772565 0.49287012785716494 -0.098693028134377331 -0.18279243915740867 -0.13286973295526033 0.038312749075611136 0.059172982666507064 0.0248596829661187;1 0.45676159158707752 -0.31743199562882501 -0.0025531480277131004 0.64052140948878999 -0.50454095850310055 -0.10338350280716449 0.0528790871122218 0.3075389731167455 0.026955386747703751 -0.0192938183401541 -0.182666967706474 -0.071216596640386001 0.061679316805770899 0.071867020620131006 -0.157270159731704 0.12433951730803949;1 0.54699475641538087 -0.080309128401959251 -0.073364280583480532 0.79259393711965198 -0.072423362651935691 -0.17374274023040398 0.2215663780124108 0.45670881167794292 0.017484637922852975 -0.04305033332383093 -0.13699762157852011 -0.041340237309935982 0.037961213857450493 0.073684155710987492 -0.063711635023906713 0.092150217404250861;0.99999999999999989 0.42573295605980743 -0.40317403038582122 0.20881487543732313 0.64119897816814009 -0.58827066717265497 -0.099952995618377449 0.61848610197508658 0.5450144044453169 -0.030401713050900985 -0.050937865387211179 -0.19737301260844181 -0.068323777586288909 0.033511509923432742 0.056867841620263607 -0.12363193912172271 0.12795323233705602;0.99999999999999978 -0.41641544284369719 0.06662522801057999 -0.16523276080111293 0.54923489894810851 -0.40460417828302869 -0.19917630260603497 0.39823725977540964 0.46142859785053891 0.026157940613094337 -0.13271802742089681 -0.12460544083623734 -0.090552490349540632 0.029532366912607428 0.065922638921625726 -0.10419738764065464 0.145420916932155;1.0000000000000002 -0.81373510640757385 0.28034626828680087 -0.32161617540195009 0.51555715993439077 -0.35363255311941028 -0.26821918379191367 0.34487062705860261 0.39751508611607728 0.061428112402869835 -0.19141095717016199 -0.15329317672370932 0.033932476862587553 0.0040344596969624589 0.084053451197475024 -0.054819906614691868 0.17590701129811423;0.99999999999999978 -0.86388367969291335 0.2827676412699951 -0.32804588551523983 0.5526746884657544 -0.36600511819864701 -0.29013684784443439 0.4283753285970639 0.52236693394643297 0.063188693824082834 -0.044489541219979542 -0.10564507266123199 -0.15860090408039679 0.056456799217077233 0.065190040097002952 -0.11920151541179791 0.1251909416065948;1 -1.134517333439272 0.40872446120813188 -0.48760624532567082 0.7602915171882918 -0.51685899983170835 -0.36755586505326393 0.37891771112840167 0.5097102406565136 -0.088321381265331594 -0.023056926478834158 -0.23916847422158555 0.017183956400527747 0.044025327583815915 0.045708026336462267 -0.17548089821510554 0.038959047460427956;0.44444444444444442 -0.99371727721062886 0.72904686129715235 -0.21758686889022502 0.74414151999429579 -0.068446639491366174 -0.042752247392790391 0.25382432017120848 0.35149870450253079 0.16527921580136107 0.26141855210797699 -0.18202010956350026 -0.10827988586948996 -0.032365910212318119 0.045280542593098563 -0.035396945506488489 0.030489527621791582;0 -0.90973444535180525 1.0017654933465618 0.006990714985193637 0.73894738537702986 0.33990294768680696 0.16955876867044728 0.14971768729931145 0.21519601636637375 0.36340510755527389 0.507260914752661 -0.15167463734325937 -0.20764898557544725 -0.095771600491586881 0.044371466737677438 0.072811973861279841 0.021344628977878054;0 -0.9195371677218358 0.95775625045783563 -0.0077235306405731936 0.77314435392985215 0.29265273812141679 0.49349649039109356 0.29357544566948718 0.11678220880564362 0.26910912683534982 0.49557323522543462 -0.037925788104089087 -0.21046178128255758 -0.10158772411134045 -0.01155203260284121 0.089746840602536057 0.024474311381412803];

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX
    X = {X};
end

% Dimensions
TS = size(X,2); % timesteps

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS
    
    % Input 1
    X{1,ts} = X{1,ts}';
    % no processing
    
    % Layer 1
    z1 = negdist_apply(IW1_1,X{1,ts});
    a1 = compet_apply(z1);
    
    % Output 1
    Y{1,ts} = a1;
    Y{1,ts} = Y{1,ts}';
end

% Final Delay States
Xf = cell(1,0);
Af = cell(1,0);

% Format Output Arguments
if ~isCellX
    Y = cell2mat(Y);
end
end

% ===== MODULE FUNCTIONS ========

% Negative Distance Weight Function
function z = negdist_apply(w,p,~)
[S,R] = size(w);
Q = size(p,2);
if isa(w,'gpuArray')
    z = iNegDistApplyGPU(w,p,R,S,Q);
else
    z = iNegDistApplyCPU(w,p,S,Q);
end
end
function z = iNegDistApplyCPU(w,p,S,Q)
z = zeros(S,Q);
if (Q<S)
    pt = p';
    for q=1:Q
        z(:,q) = sum(bsxfun(@minus,w,pt(q,:)).^2,2);
    end
else
    wt = w';
    for i=1:S
        z(i,:) = sum(bsxfun(@minus,wt(:,i),p).^2,1);
    end
end
z = -sqrt(z);
end
function z = iNegDistApplyGPU(w,p,R,S,Q)
p = reshape(p,1,R,Q);
sd = arrayfun(@iNegDistApplyGPUHelper,w,p);
z = -sqrt(reshape(sum(sd,2),S,Q));
end
function sd = iNegDistApplyGPUHelper(w,p)
sd = (w-p) .^ 2;
end

% Competitive Transfer Function
function a = compet_apply(n,~)
if isempty(n)
    a = n;
else
    [S,Q] = size(n);
    nanInd = any(isnan(n),1);
    a = zeros(S,Q,'like',n);
    [~,maxRows] = max(n,[],1);
    onesInd = maxRows + S*(0:(Q-1));
    a(onesInd) = 1;
    a(:,nanInd) = NaN;
end
end
